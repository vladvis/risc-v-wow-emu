{% for i in range(chunks_len) %}
function Load_Chunk{{name}}{{ i }}(CPU)
    local mem_sections = {
    {% for address, value in chunks[i].items() %}
        [{{ address | hex }}] = {{ value | hex }},{% endfor %}
    }
    CPU:SetMemory(CPU, mem_sections)
end
{% endfor %}

function Init_{{ name }}(CPU)
    CPU.entrypoint = {{ entrypoint | hex }}
    CPU.stack_pointer = {{ stack_pointer | hex }}
    CPU.heap_start = {{ heap_start | hex }}

    {% for i in range(chunks_len) %}
    Load_Chunk{{name}}{{i}}(CPU)
    {% endfor %}
    CPU:StoreRegister(2, {{ stack_pointer | hex }})
    CPU.memory:InitMemoryRange(0x7fe00000, 0x7ff00004)
end
