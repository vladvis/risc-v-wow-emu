function Init_{{ name }}(CPU)
    CPU.entrypoint = {{ entrypoint | hex }}
    CPU.stack_pointer = {{ stack_pointer | hex }}
    CPU.heap_start = {{ heap_start | hex }}

    local mem_sections = {
    {% for address, value in memory_map.items() %}
        [{{ address | hex }}] = {{ value | hex }},{% endfor %}
    }
    CPU:SetMemory(CPU, mem_sections)
    CPU:StoreRegister(2, {{ stack_pointer | hex }})
    CPU.memory:InitMemoryRange(0x7fe00000, 0x7ff00004)
end
